<!-- Sidebar Content -->
<div class="px-3 py-6">
  
  <!-- Sidebar Header -->
 <div class="mb-8 px-3">
    <div class="flex items-center gap-3">
        <!-- Logo container -->
        <div class="w-12 h-12 rounded-lg bg-gray-100 flex items-center justify-center overflow-hidden">
            {% if organization.logo %}
                <img src="{{ organization.logo.url }}" alt="Logo" class="w-full h-full object-cover">
            {% else %}
                <i class="fas fa-seedling text-xl text-gray-700"></i>
            {% endif %}
        </div>

        <!-- Text -->
        <div>
            <h3 class="text-gray-900 font-semibold text-sm">{{ organization.name|capfirst }}</h3>
            <p class="text-gray-500 text-xs">Management Panel</p>
        </div>
    </div>
</div>


  <!-- Navigation Menu -->
  <nav class="space-y-0.5">
    
    <!-- Dashboard -->
    <a href="{% url 'admin_dashboard_page'%}" class="sidebar-link">
      <i class="fas fa-home"></i>
      <span>Dashboard</span>
    </a>

    <!-- Orders -->
    <div class="nav-group">
      <button class="sidebar-link dropdown-toggle w-full" data-dropdown="orders">
        <i class="fas fa-shopping-cart"></i>
        <span class="flex-1 text-left">Orders</span>
        <span class="text-xs text-red-500 font-bold">12</span>
        <i class="fas fa-chevron-down text-xs dropdown-icon transition-transform duration-200"></i>
      </button>
      <div class="dropdown-menu" data-dropdown-id="orders">
        <a href="{% url 'admin_order_list_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-list"></i>
          <span>All Orders</span>
        </a>
        <a href="{% url 'admin_order_pending_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-clock"></i>
          <span>Pending</span>
          <span class="ml-auto text-xs text-red-500">{{total_pending_orders}}</span>
        </a>
        <a href="{% url 'admin_order_delivered_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-check-circle"></i>
          <span>Delivered</span>
        </a>
      </div>
    </div>

    <!-- Farmers -->
    <div class="nav-group">
      <button class="sidebar-link dropdown-toggle w-full" data-dropdown="farmers">
        <i class="fas fa-tractor"></i>
        <span class="flex-1 text-left">Farmers</span>
        <i class="fas fa-chevron-down text-xs dropdown-icon transition-transform duration-200"></i>
      </button>
      <div class="dropdown-menu" data-dropdown-id="farmers">
        <a href="{% url 'admin_farmer_list_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-list"></i>
          <span>All Farmers</span>
        </a>
        <a href="{% url 'admin_farmer_kyc_pending_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-user-check"></i>
          <span>KYC Pending</span>
          <span class="ml-auto text-xs text-red-500 font-bold">{{total_farmer_kyc_pending}}</span>
        </a>
        <a href="{% url 'admin_farmer_payout_requests_page' %}" class="sidebar-link text-sm py-2">
          <i class="fas fa-money-bill-wave"></i>
          <span>Payout Requests</span>
          <span class="ml-auto text-xs text-red-500 font-bold">{{total_farmer_payout_requests}}</span>
        </a>
      </div>
    </div>

    <!-- Vendors -->
    <div class="nav-group">
      <button class="sidebar-link dropdown-toggle w-full" data-dropdown="vendors">
        <i class="fas fa-store"></i>
        <span class="flex-1 text-left">Vendors</span>
        <i class="fas fa-chevron-down text-xs dropdown-icon transition-transform duration-200"></i>
      </button>
      <div class="dropdown-menu" data-dropdown-id="vendors">
        <a href="{% url 'admin_vendor_list_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-list"></i>
          <span>All Vendors</span>
        </a>
        <a href="{% url 'admin_vendor_kyc_pending_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-user-check"></i>
          <span>KYC Pending</span>
          <span class="ml-auto text-xs text-red-500 font-bold">{{total_vendor_kyc_pending}}</span>
        </a>
        <a href="{% url 'admin_vendor_payout_requests_page' %}" class="sidebar-link text-sm py-2">
          <i class="fas fa-money-bill-wave"></i>
          <span>Payout Requests</span>
          <span class="ml-auto text-xs text-red-500">{{total_vendor_payout_requests}}</span>

        </a>
      </div>
    </div>

    <!-- Products -->
    <div class="nav-group">
      <button class="sidebar-link dropdown-toggle w-full" data-dropdown="products">
        <i class="fas fa-leaf"></i>
        <span class="flex-1 text-left">Products</span>
        <i class="fas fa-chevron-down text-xs dropdown-icon transition-transform duration-200"></i>
      </button>
      <div class="dropdown-menu" data-dropdown-id="products">
        <a href="{% url 'admin_all_farmer_product_list_page' %}" class="sidebar-link text-sm py-2">
          <i class="fas fa-warehouse"></i>
          <span>Farmer Products</span>
        </a>
        <a href="{% url 'admin_all_vendor_product_list_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-store-alt"></i>
          <span>Vendor Products</span>
        </a>
        <a href="{% url 'admin_category_list_page'%}" class="sidebar-link text-sm py-2">
          <i class="fas fa-tags"></i>
          <span>Categories</span>
        </a>
      </div>
    </div>

    <!-- Customers -->
    <a href="{% url 'admin_customer_list_page' %}" class="sidebar-link">
      <i class="fas fa-users"></i>
      <span>Customers</span>
    </a>

    <!-- Reviews -->
    <a href="{% url 'admin_review_list_page' %}" class="sidebar-link">
      <i class="fas fa-star"></i>
      <span>Reviews & Ratings</span>
    </a>

    <!-- Divider -->
    <div class="my-4 border-t border-gray-200"></div>

    <!-- Finance -->
    <div class="nav-group">
      <button class="sidebar-link dropdown-toggle w-full" data-dropdown="finance">
        <i class="fas fa-wallet"></i>
        <span class="flex-1 text-left">Finance</span>
        <i class="fas fa-chevron-down text-xs dropdown-icon transition-transform duration-200"></i>
      </button>
      <div class="dropdown-menu" data-dropdown-id="finance">
        <a href="{% url 'admin_wallet_page' %}" class="sidebar-link text-sm py-2">
          <i class="fas fa-university"></i>
          <span>Admin Wallet</span>
        </a>
        <a href="{% url 'admin_commission_rate_page' %}" class="sidebar-link text-sm py-2">
          <i class="fas fa-percentage"></i>
          <span>Commission Rate</span>
        </a>
        <a href="{% url 'admin_revenue_report_page' %}" class="sidebar-link text-sm py-2">
          <i class="fas fa-chart-line"></i>
          <span>Revenue Reports</span>
        </a>
      </div>
    </div>

    <!-- Notifications -->
    <a href="{% url 'admin_notification_list_page' %}" class="sidebar-link">
      <i class="fas fa-bell"></i>
      <span>Notifications</span>
      <span class="ml-auto text-xs text-red-500 font-medium">{{ unread_count|default:"0" }}</span>
    </a>

    <!-- Activity Logs -->
    <a href="{% url 'admin_activity_logs_page' %}" class="sidebar-link">
      <i class="fas fa-clipboard-list"></i>
      <span>Activity Logs</span>
    </a>

    <!-- Organization -->
    <a href="{% url 'admin_organization_page' %}" class="sidebar-link">
      <i class="fas fa-building"></i>
      <span>Organization</span>
    </a>

    <!-- Divider -->
    <div class="my-4 border-t border-gray-200"></div>

    <!-- Logout -->
    <a href="{% url 'logout'%}" class="sidebar-link text-gray-600 hover:text-red-600 hover:bg-red-50">
      <i class="fas fa-sign-out-alt"></i>
      <span>Logout</span>
    </a>

  </nav>

</div>

<!-- Dropdown Toggle Script -->
<script>
$(document).ready(function() {
  // Initialize dropdown states
  $('.dropdown-menu').each(function() {
    $(this).data('is-open', false);
  });

  // Dropdown toggle functionality
  $('.dropdown-toggle').on('click', function(e) {
    e.preventDefault();
    
    const dropdownId = $(this).data('dropdown');
    const dropdown = $(`.dropdown-menu[data-dropdown-id="${dropdownId}"]`);
    const icon = $(this).find('.dropdown-icon');
    const isOpen = dropdown.data('is-open');
    
    if (isOpen) {
      dropdown.slideUp(200);
      icon.removeClass('rotate-180');
      dropdown.data('is-open', false);
    } else {
      dropdown.slideDown(200);
      icon.addClass('rotate-180');
      dropdown.data('is-open', true);
    }
  });

  // Highlight active link based on current URL path
  const currentPath = window.location.pathname;
  $('.sidebar-link').each(function() {
    const href = $(this).attr('href');
    if (href && (href === currentPath || (currentPath.startsWith(href) && href !== '/'))) {
      $(this).addClass('active');
      
      // If it's inside a dropdown, open the dropdown
      if ($(this).closest('.dropdown-menu').length) {
        const dropdown = $(this).closest('.dropdown-menu');
        const dropdownId = dropdown.data('dropdown-id');
        const toggle = $(`.dropdown-toggle[data-dropdown="${dropdownId}"]`);
        
        dropdown.show();
        dropdown.data('is-open', true);
        toggle.find('.dropdown-icon').addClass('rotate-180');
      }
    }
  });

  // Close sidebar on mobile when clicking a link
  $('.sidebar-link').on('click', function(e) {
    if (!$(this).hasClass('dropdown-toggle')) {
      if ($(window).width() < 768) {
        $('#sidebar').removeClass('active');
        $('#overlay').removeClass('active');
      }
    }
  });
});
</script>

<style>
/* Sidebar Link Styles */
.sidebar-link {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.625rem 0.75rem;
  color: #393c42;
  text-decoration: none;
  border-radius: 0.375rem;
  font-weight: 600;
  font-size: 1rem;
  transition: all 0.15s ease;
}

.sidebar-link:hover {
  background: #f9fafb;
  color: #111827;
}

.sidebar-link.active {
  background: #f3f4f6;
  color: #111827;
}

.sidebar-link i {
  font-size: 0.9rem;
  width: 1.25rem;
  text-align: center;
  color: inherit;
}

/* Dropdown Styles */
.dropdown-menu {
  display: none;
  padding-left: 2rem;
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
}

.dropdown-menu .sidebar-link {
  padding: 0.5rem 0.75rem;
  font-size: 0.9rem;
}

.dropdown-icon {
  transition: transform 0.2s ease;
}

.rotate-180 {
  transform: rotate(180deg);
}

/* Nav Group Spacing */
.nav-group {
  margin-bottom: 0.125rem;
}
</style>